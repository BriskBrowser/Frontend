<!doctype html><html><head><meta name="viewport" content="width=device-width,user-scalable=no"><style>bb-session.old-active{transform:inherit;filter:brightness(50%);z-index:0}bb-session.active{transform:inherit;z-index:1;display:block}bb-session{--height:0px;position:fixed;transition:all .2s;transform:translateY(var(--height)) scale(.2) translateX(50%);transform-origin:top right;width:100%;top:0;z-index:2}bb-session.fullscreen:not(.active){display:none}.link{background-color:rgba(255,0,0,.1);z-index:9999;cursor:pointer;position:absolute;border:.5px solid rgba(255,0,0,.4);border-radius:3px}.link.alive{border:.5px solid rgba(0,255,0,.4)}.t{transform-origin:0 0 0;position:absolute}.scroll{overflow:scroll}::-webkit-scrollbar{display:none}
/*# sourceMappingURL=/style.css.map*/</style></head><body style="margin:0px"><div id="recreation"></div>Something seems to have gone wrong with the Brisk Browser... How about <a href="https://github.com/BriskBrowser/Frontend/blob/master/docs/contributing.md">helping us</a> fix it?<script>(()=>{"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t extends WebSocket{constructor(t){super(t+"/devtools/browser"),e(this,"req",((e,t,s)=>new Promise(((r,a)=>{this.send(JSON.stringify({id:this.nextid,method:t,params:s,sessionId:e})),this.callbacks[this.nextid]={resolve:r,reject:a},this.nextid++})))),this.nextid=0,this.callbacks=[],this.eventListeners=[],this.childSockets=[],this.addEventListener("message",(e=>{var t=JSON.parse(e.data);this.callbacks[t.id]?(t.result?this.callbacks[t.id].resolve(t.result):this.callbacks[t.id].reject(t.error),delete this.callbacks[t.id]):this.eventListeners[t.method]&&this.eventListeners[t.method](t.params),this.childSockets.forEach((e=>e.handleMessage(t)))}))}}class s{constructor(t,s){e(this,"req",((e,t)=>this.ws.req(this.sessionId,e,t))),e(this,"handleMessage",(e=>{e.sessionId==this.sessionId&&this.eventListeners[e.method]&&this.eventListeners[e.method](e.params)})),e(this,"destroy",(()=>{this.ws.childSockets=this.ws.childSockets.filter((e=>e!=this))})),this.ws=t,this.sessionId=s,this.eventListeners=[],this.ws.childSockets.push(this)}}function r(e,t=new WeakMap){if(Object(e)!==e)return e;if(!(e instanceof Function)){if(e instanceof HTMLElement)return e.sharable?e:void 0;if(t.has(e))return t.get(e);var s=new e.constructor;return t.set(e,s),Object.assign(s,...Object.keys(e).map((s=>({[s]:r(e[s],t)}))))}}class a{constructor(e,t){this.sessionState={preventscroll:0,nextLayerUpdates:[],comittedLayerUpdates:[],layer_tree:[],keyboard:{showing:!1}},this.ws=e,this.onNewSession=()=>{},this.onSessionActivate=()=>{},this.onSessionSetHeight=()=>{},t&&(this.sessionState=r(t.sessionState)),this.ws.eventListeners["PageStream.streamLayerInfo"]=t=>{this.sessionState.nextLayerUpdates.push(t.layerUpdate),t.layerUpdate.targets&&t.layerUpdate.targets.forEach((t=>{t.sessionId&&this.onNewSession(e.ws,t.sessionId,this)}))},this.ws.eventListeners["PageStream.streamPropTrees"]=e=>{this.sessionState.nextProptrees=JSON.parse(e.propertyTreesJSON),this.fullUpdateRequired=!0},this.ws.eventListeners["PageStream.frameDone"]=()=>{this.sessionState.comittedLayerUpdates=this.sessionState.comittedLayerUpdates.concat(this.sessionState.nextLayerUpdates),this.sessionState.nextLayerUpdates=[],this.sessionState.nextProptrees&&(this.sessionState.comittedProptrees=this.sessionState.nextProptrees,delete this.sessionState.nextProptrees),this.scheduleUpdateScreen()},this.ws.eventListeners["PageStream.keyboardStateChange"]=e=>{this.sessionState.keyboard=e,this.updateKeyboard()}}set domElement(e){this.domElement_&&this.domElement_.remove(),this.domElement_=e,e&&(["touchStart","touchEnd","touchCancel","touchMove"].forEach((t=>e.addEventListener(t.toLowerCase(),this.touch.bind(this,t),{passive:!0}))),this.keyboard=document.createElement("textarea"),this.keyboard.style="width: 0px; height: 0px; position: absolute; z-index: -999",this.keyboard.oninput=this.keyboardHandler.bind(this),this.keyboardUpdateBlockedCtr=0,e.appendChild(this.keyboard),this.updateKeyboard()),this.updateScreen()}updateKeyboard(){if(this.keyboard&&!this.keyboardUpdateBlockedCtr){var e=this.sessionState.keyboard;this.keyboard.innerText=e.inputBoxValue,this.keyboard.setSelectionRange(e.selectionStart,e.selectionEnd),e.showing?(this.keyboard.focus(),this.domElement_.onmousedown=e=>{e.preventDefault()}):(this.keyboard.blur(),this.domElement_.onmousedown=null)}}async keyboardHandler(e){this.keyboardUpdateBlockedCtr++,await this.ws.req("PageStream.setKeyboardState",{inputBoxValue:e.target.value,selectionStart:e.target.selectionStart,selectionEnd:e.target.selectionEnd}),this.keyboardUpdateBlockedCtr--}decodeLayerInfo(e){var t=e.split("\n").map((e=>e.split(":"))).filter((e=>e.length>1)).reduce(((e,t)=>(e[t[0].trim()]=t[1].trim(),e)),{}),s={layerId:t.layer_id};return s.drawsContent="0x0"!=t.Bounds,s.name=t.name,s.bounds=t.Bounds.split("x").map((e=>parseInt(e))),s.offsetToTransformParent=t.OffsetToTransformParent.split(" ").map((e=>parseFloat(e.replace(/[^\d.-]/g,"")))),s.clip_tree_index=parseInt(t.clip_tree_index),s.effect_tree_index=parseInt(t.effect_tree_index),s.scroll_tree_index=parseInt(t.scroll_tree_index),s.transform_tree_index=parseInt(t.transform_tree_index),s}createDOMTransformNode(e,t,s){if(e.parent_id){!e.dom&&s&&s.adoptable&&(e.dom=s);var r=e.zIndex||-1;(r<t||!e.dom||e.dom.adoptable)&&(e.zIndex=Math.max(t,r),this.createDOMTransformNode(e.parent_id,t,e.dom&&e.dom.parentNode)),e.dom||(e.dom=document.createElement("div"),e.parent_id.dom.appendChild(e.dom)),e.dom.adoptable=!1,e.dom.parentNode!=e.parent_id.dom&&e.parent_id.dom.appendChild(e.dom),e.dom.classList.add("t"),e.dom.setAttribute("t"+e.id,""),r!=e.zIndex&&(e.dom.style.zIndex=e.zIndex),e.clip?(e.dom.style.width=e.clip.clip[2]+"px",e.dom.style.height=e.clip.clip[3]+"px",e.dom.style.top=e.clip.clip[1]+"px",e.dom.style.left=e.clip.clip[0]+"px",e.clip.clip[0]||e.clip.clip[1]?e.dom.style.transform=`matrix3d(1,0,0,0, 0,1,0,0, 0,0,1,0, ${e.clip.clip[0]},${e.clip.clip[1]},0,1) `+this.toCss(e.local):e.dom.style.transform=this.toCss(e.local)):e.dom.style.transform=this.toCss(e.local),e.scroll&&(this.sessionState.preventscrollElem,e.scroll.element_id.id_),e.dom.onscroll=e.scroll?this.scrollHandler.bind(this,e):void 0,e.dom.classList.toggle("scroll",!!e.scroll)}else e.dom=this.domElement_}updateTargetHeights(){this.sessionState.layer_tree.forEach((e=>{Object.keys(e.targets).forEach((t=>{var s=e.targets[t];s.sessionId&&s.containingQuads&&this.onSessionSetHeight(s.sessionId,s.containingQuads[0][1])}))}))}scrollHandler(e,t){this.sessionState.preventscroll++,this.sessionState.preventscrollElem=e.scroll.element_id.id_,this.ws.req("PageStream.setScroll",{backendNodeId:e.scroll.element_id.id_,x:Math.floor(e.dom.scrollLeft),y:Math.floor(e.dom.scrollTop)}).then((e=>{this.sessionState.preventscroll--})),this.updateTargetHeights()}createDOMLayerImages(e){e.images&&e.images.forEach((t=>{t.dom.activeInLayer!=e&&(e.dom.appendChild(t.dom),t.dom.style.position="absolute",t.dom.style.top=t.clip.y+"px",t.dom.style.left=t.clip.x+"px",t.dom.width=t.clip.width,t.dom.height=t.clip.height,t.dom.activeInLayer=e)}))}createDOMLayerNode(e){e.images&&"Frame Overlay Content Layer"!=e.name&&(e.clip_tree_index.transform_id===e.scroll_tree_index.transform_id.parent_id&&e.scroll_tree_index.scrollable&&(e.scroll_tree_index.transform_id.scroll=e.scroll_tree_index,e.scroll_tree_index.transform_id.clip=e.clip_tree_index,this.createDOMTransformNode(e.scroll_tree_index.transform_id,0,e.scrolldom),e.scrolldom=e.scroll_tree_index.transform_id.dom),this.createDOMTransformNode(e.transform_tree_index,e.zIndex,e.dom&&e.dom.parentNode),e.dom||(e.dom=document.createElement("div")),e.dom.parentNode!=e.transform_tree_index.dom&&e.transform_tree_index.dom.appendChild(e.dom),this.createDOMLayerImages(e),e.dom.style.top=e.offsetToTransformParent[1]+"px",e.dom.style.left=e.offsetToTransformParent[0]+"px",e.dom.style.width=e.bounds[0]+"px",e.dom.style.height=e.bounds[1]+"px",e.dom.style.overflow="hidden",e.dom.style.position="absolute",e.dom.style.zIndex=e.zIndex,e.dom.setAttribute("l"+e.layerId,e.name),e.targets&&Object.keys(e.targets).forEach((t=>{this.createTargetNode(e.targets[t],e)})))}targetTouch(e,t){"touchStart"==e&&1==t.touches.length?t.currentTarget.metadata.touchStarted=!0:"touchEnd"==e&&t.currentTarget.metadata.touchStarted?(t.currentTarget.metadata.sessionId&&this.onSessionActivate(t.currentTarget.metadata.sessionId),this.ws.req("PageStream.clickNode",{backendNodeId:t.currentTarget.metadata.backendNodeId}),t.cancel=!0):delete t.currentTarget.metadata.touchStarted}createTargetNode(e,t){if(e.containingQuads){var s=t.dom.parentNode;e.dom||(e.dom=document.createElement("div"),["touchStart","touchEnd","touchCancel","touchMove"].forEach((t=>e.dom.addEventListener(t.toLowerCase(),this.targetTouch.bind(this,t),{passive:!0})))),e.dom.parentNode!=s&&s.appendChild(e.dom),e.dom.style.left=e.containingQuads[0][0]+"px",e.dom.style.top=e.containingQuads[0][1]+"px",e.dom.style.width=e.containingQuads[0][4]-e.containingQuads[0][0]+"px",e.dom.style.height=e.containingQuads[0][5]-e.containingQuads[0][1]+"px",e.dom.metadata=e,e.dom.classList.add("link"),e.dom.classList.toggle("alive",!!e.sessionId)}}toCss(e){var t="matrix3d("+(e=Array(16).fill().reverse().map(((t,s)=>e[Math.floor(s/4)+s%4*4]))).join(",")+")";return"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)"==t?"":t}makeTrees(e){var t=e.clip_tree.nodes.reduce(((e,t)=>(e[t.id]=t,e)),[]),s=e.effect_tree.nodes.reduce(((e,t)=>(e[t.id]=t,e)),[]),r=e.scroll_tree.nodes.reduce(((e,t)=>(e[t.id]=t,e)),[]),a=e.transform_tree.nodes.reduce(((e,t)=>(e[t.id]=t,e)),[]),i=this.sessionState.layer_tree;function o(e){return Number.isInteger(e)||void 0===e?e:e.id}i.forEach((e=>{e.clip_tree_index=t[o(e.clip_tree_index)],e.effect_tree_index=s[o(e.effect_tree_index)],e.scroll_tree_index=r[o(e.scroll_tree_index)],e.transform_tree_index=a[o(e.transform_tree_index)]})),a.forEach((e=>{e.parent_id=a[o(e.parent_id)]})),r.forEach((e=>{e.parent_id=r[o(e.parent_id)],e.transform_id=a[o(e.transform_id)]})),s.forEach((e=>{e.parent_id=s[o(e.parent_id)],e.transform_id=a[o(e.transform_id)],e.clip_id=t[o(e.clip_id)]})),t.forEach((e=>{e.parent_id=t[o(e.parent_id)],e.transform_id=a[o(e.transform_id)]})),this.sessionState={...this.sessionState,clip_tree:t,effect_tree:s,scroll_tree:r,transform_tree:a,layer_tree:i}}scheduleUpdateScreen(){this.requestAnimationFrameCallback&&cancelAnimationFrame(this.requestAnimationFrameCallback),this.requestAnimationFrameCallback=requestAnimationFrame(this.updateScreen.bind(this))}updateScreen(){if(this.sessionState.comittedLayerUpdates.forEach((e=>{var t=this.sessionState.layer_tree[e.layerId]=this.sessionState.layer_tree[e.layerId]||{targets:{}};if((e.layerDeleted||e.layerInfo||e.zIndex||e.targets)&&(this.fullUpdateRequired=!0),e.layerDeleted)return t.dom&&t.dom.remove(),t.targets&&Object.keys(t.targets).forEach((e=>t.targets[e].dom&&t.targets[e].dom.remove())),void delete this.sessionState.layer_tree[e.layerId];e.layerInfo&&(this.sessionState.layer_tree[e.layerId]=t={...t,...this.decodeLayerInfo(e.layerInfo)}),e.zIndex&&(t.zIndex=e.zIndex),e.bufferUpdates&&(t.images=t.images||[],e.bufferUpdates.forEach((e=>{for(let s=t.images.length-1;s>=0;s--)t.images[s].clip.x>=e.clip.x&&t.images[s].clip.y>=e.clip.y&&t.images[s].clip.x+t.images[s].clip.width<=e.clip.x+e.clip.width&&t.images[s].clip.y+t.images[s].clip.height<=e.clip.y+e.clip.height&&(t.images[s].dom.activeInLayer==t&&t.images[s].dom.remove(),t.images.splice(s,1));var s;e.image&&((s=new Image).src=e.image,s.decode(),s.sharable=!0),t.images.push({clip:e.clip,dom:s})}))),e.targets&&e.targets.forEach((e=>{if(e.targetDeleted){var s=t.targets[e.backendNodeId];s.dom&&s.dom.remove(),delete t.targets[e.backendNodeId]}else t.targets[e.backendNodeId]=t.targets[e.backendNodeId]||{},Object.assign(t.targets[e.backendNodeId],e)}))})),this.sessionState.comittedLayerUpdates=[],this.domElement_){var e=this.sessionState.transform_tree;e&&e.forEach((e=>{e.dom&&e.parent_id&&(e.dom.adoptable=!0)})),this.sessionState.comittedProptrees&&this.fullUpdateRequired&&this.makeTrees(this.sessionState.comittedProptrees),this.sessionState.layer_tree.forEach((e=>{this.fullUpdateRequired?this.createDOMLayerNode(e):this.createDOMLayerImages(e)})),e&&e.forEach((e=>{e.dom&&1==e.dom.adoptable&&e.dom.remove()})),this.updateTargetHeights()}}resize(){this.ws.req("Emulation.setDeviceMetricsOverride",{height:window.innerHeight,width:Math.floor(window.innerWidth),deviceScaleFactor:window.devicePixelRatio,mobile:!0})}touch(e,t){t.cancel&&(e="touchCancel"),this.ws.req("Input.dispatchTouchEvent",{type:e,touchPoints:Array(...t.touches).map((e=>({x:e.clientX,y:e.clientY,id:e.identifier})))})}destroy(){this.ws.destroy(),this.domElement=null}}let i={fullscreen:!1};"undefined"!=typeof BBOptionsOverrides&&Object.assign(i,BBOptionsOverrides),window.addEventListener("DOMContentLoaded",(async e=>{(class{constructor(e,t){this.rootElement=e,this.options=t}async init(){let e=(s=i.websocketServer,r=i.websocketPool,new Promise((function(e,a){let i=[];function o(){if(!i.resolved&&(i.doneCount/i.length>=.9&&i.highestOpen>=0||i.doneCount==i.length)){let s=i.filter((e=>e.load));s.sort(((e,t)=>e.load-t.load)),i.resolved=!0;var t=0!=s.length?s[0].ws:null;t?e(t):a(i.lasterr),i.forEach((e=>e.ws!=t&&e.ws.close()))}}s?i.push({id:0,ws:new t(s)}):r?i=i.concat([...Array(10).keys()].map((e=>Math.floor(Math.random()*Math.pow(4,e)))).map((e=>({id:e,ws:new t("wss://"+e+"."+r)})))):i.push({id:0,ws:new t(document.location.origin.replace("http","ws"))}),i.doneCount=0,i.highestOpen=-1,i.forEach((e=>{e.ws.onopen=async()=>{try{e.load=1==i.length?1:await e.ws.req(void 0,"Load.GetLoad",{})}catch{e.load=1}i.doneCount++,i.highestOpen=Math.max(i.highestOpen,e.id),o()},e.ws.onerror=e=>{i.doneCount++,i.lasterr=e,o()}}))})));var s,r,a=await e,o={};window.navigator.userAgent.match(/Chrome\/[.0-9]* Mobile/)||alert("Hold Up!  We only support Android Chrome right now...   Click OK to try anyway...   But it probably won't work :-("),window.sessions=o,a.req(void 0,"Target.setDiscoverTargets",{discover:!0}),a.eventListeners["Target.targetCreated"]=function(e){"page"!=e.targetInfo.type||this.attached||(a.req(void 0,"Target.attachToTarget",{targetId:e.targetInfo.targetId,flatten:!0}),this.attached=!0)},a.eventListeners["Target.attachedToTarget"]=e=>{console.log("new target",e);var t=addSession(a,e.sessionId,null);sessionActivate(e.sessionId),t.resize(),t.ws.req("Page.enable",{}),t.ws.req("PageStream.enable",{fps:0,targetBandwidth:999999999}),t.ws.req("Page.navigate",{url:currentURL()})},a.eventListeners["Target.detachedFromTarget"]=e=>{o[e.sessionId].destroy(),delete o[e.sessionId],arrangeSessions()},a.eventListeners["Target.targetInfoChanged"]=e=>{},window.addEventListener("resize",(()=>{Object.values(o).forEach((e=>e.resize()))}))}currentURL(){var e=document.location.pathname,t=document.location.search;return e.startsWith("/http")?e.substring(1)+t+document.location.hash:t.startsWith("?http")?t.substring(1)+document.location.hash:document.location.href}arrangeSessions(){}sessionSetHeight(e,t,s){sessions[e].childArrangement=sessions[e].childArrangement||{},sessions[e].childArrangement[t]=s,arrangeSessions()}sessionActivate(e){var t=document.createElement("bb-session");document.querySelector("#recreation").appendChild(t),t.classList.add("active"),activeSession&&(sessions[activeSession].domElement=null),sessions[e].domElement=t,activeSession=e,arrangeSessions()}addSession(e,t,r){if(!sessions[t]){var i=new s(e,t),o=new a(i,r);return sessions[t]=o,o.onNewSession=addSession,o.onSessionActivate=sessionActivate,o.onSessionSetHeight=sessionSetHeight.bind(this,t),o}}})(document.quertSelector("#recreation"),i).init()}))})();
//# sourceMappingURL=/index.js.map</script><script></script></body></html>